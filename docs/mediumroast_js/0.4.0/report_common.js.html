

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> report/common.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="Search docs..." class="input">
                </div>
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Classes</h3><ul><li><a href="AddCompany.html">AddCompany</a></li><li><a href="AddInteraction.html">AddInteraction</a></li><li><a href="ArchivePackage.html">ArchivePackage</a></li><li><a href="Auth.html">Auth</a></li><li><a href="Auth0Auth.html">Auth0Auth</a></li><li><a href="baseObjects.html">baseObjects</a></li><li><a href="CLIOutput.html">CLIOutput</a></li><li><a href="CLIUtilities.html">CLIUtilities</a></li><li><a href="Companies.html">Companies</a></li><li><a href="CompanyDashbord.html">CompanyDashbord</a></li><li><a href="CompanySection.html">CompanySection</a></li><li><a href="CompanyStandalone.html">CompanyStandalone</a></li><li><a href="DOCXUtilities.html">DOCXUtilities</a></li><li><a href="Environmentals.html">Environmentals</a></li><li><a href="GitHubFunctions.html">GitHubFunctions</a></li><li><a href="Interactions.html">Interactions</a></li><li><a href="InteractionSection.html">InteractionSection</a></li><li><a href="InteractionStandalone.html">InteractionStandalone</a></li><li><a href="MinioUtilities.html">MinioUtilities</a></li><li><a href="mrRest.html">mrRest</a></li><li><a href="s3Utilities.html">s3Utilities</a></li><li><a href="serverOperations.html">serverOperations</a></li><li><a href="Studies.html">Studies</a></li><li><a href="Users.html">Users</a></li><li><a href="Utilities.html">Utilities</a></li><li><a href="WizardUtils.html">WizardUtils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addConfigSection">addConfigSection</a></li><li><a href="global.html#addMinioUser">addMinioUser</a></li><li><a href="global.html#basicComparisonRow">basicComparisonRow</a></li><li><a href="global.html#basicRow">basicRow</a></li><li><a href="global.html#basicTopicRow">basicTopicRow</a></li><li><a href="global.html#bubbleChart">bubbleChart</a></li><li><a href="global.html#checkConfigDir">checkConfigDir</a></li><li><a href="global.html#checkFilesystemObject">checkFilesystemObject</a></li><li><a href="global.html#checkFilesystemObjectType">checkFilesystemObjectType</a></li><li><a href="global.html#checkServer">checkServer</a></li><li><a href="global.html#cleanWorkingDirs">cleanWorkingDirs</a></li><li><a href="global.html#createContainers">createContainers</a></li><li><a href="global.html#createObj">createObj</a></li><li><a href="global.html#createRepository">createRepository</a></li><li><a href="global.html#createZIPArchive">createZIPArchive</a></li><li><a href="global.html#decodeJWT">decodeJWT</a></li><li><a href="global.html#deleteObj">deleteObj</a></li><li><a href="global.html#descriptionRow">descriptionRow</a></li><li><a href="global.html#doManual">doManual</a></li><li><a href="global.html#downloadBinary">downloadBinary</a></li><li><a href="global.html#extractZIPArchive">extractZIPArchive</a></li><li><a href="global.html#findById">findById</a></li><li><a href="global.html#findByName">findByName</a></li><li><a href="global.html#findByX">findByX</a></li><li><a href="global.html#getAll">getAll</a></li><li><a href="global.html#getConfig">getConfig</a></li><li><a href="global.html#getConfigSetting">getConfigSetting</a></li><li><a href="global.html#getEnv">getEnv</a></li><li><a href="global.html#getGitHubOrg">getGitHubOrg</a></li><li><a href="global.html#getMostSimilarCompany">getMostSimilarCompany</a></li><li><a href="global.html#getObj">getObj</a></li><li><a href="global.html#getOwningCompany">getOwningCompany</a></li><li><a href="global.html#initWorkingDirs">initWorkingDirs</a></li><li><a href="global.html#linkObj">linkObj</a></li><li><a href="global.html#listAllFiles">listAllFiles</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#makeBookmark">makeBookmark</a></li><li><a href="global.html#makeBullet">makeBullet</a></li><li><a href="global.html#makeComparisonDOCX">makeComparisonDOCX</a></li><li><a href="global.html#makeDescriptionsDOCX">makeDescriptionsDOCX</a></li><li><a href="global.html#makeDocx">makeDocx</a></li><li><a href="global.html#makeDOCX">makeDOCX</a></li><li><a href="global.html#makeExternalHyperLink">makeExternalHyperLink</a></li><li><a href="global.html#makeFirmographicsDOCX">makeFirmographicsDOCX</a></li><li><a href="global.html#makeHeader">makeHeader</a></li><li><a href="global.html#makeHeading1">makeHeading1</a></li><li><a href="global.html#makeHeading2">makeHeading2</a></li><li><a href="global.html#makeHeading3">makeHeading3</a></li><li><a href="global.html#makeHeadingBookmark1">makeHeadingBookmark1</a></li><li><a href="global.html#makeHeadingBookmark2">makeHeadingBookmark2</a></li><li><a href="global.html#makeInternalHyperLink">makeInternalHyperLink</a></li><li><a href="global.html#makeIntro">makeIntro</a></li><li><a href="global.html#makeParagraph">makeParagraph</a></li><li><a href="global.html#makeReferencesDOCX">makeReferencesDOCX</a></li><li><a href="global.html#makeTextrun">makeTextrun</a></li><li><a href="global.html#operationOrNot">operationOrNot</a></li><li><a href="global.html#outputCLI">outputCLI</a></li><li><a href="global.html#pageBreak">pageBreak</a></li><li><a href="global.html#parseCLIArgs">parseCLIArgs</a></li><li><a href="global.html#postObj">postObj</a></li><li><a href="global.html#printLine">printLine</a></li><li><a href="global.html#rankTags">rankTags</a></li><li><a href="global.html#readConfig">readConfig</a></li><li><a href="global.html#readJSONFile">readJSONFile</a></li><li><a href="global.html#readTextFile">readTextFile</a></li><li><a href="global.html#refreshAccessToken">refreshAccessToken</a></li><li><a href="global.html#removeConfigSetting">removeConfigSetting</a></li><li><a href="global.html#rmDir">rmDir</a></li><li><a href="global.html#rmObj">rmObj</a></li><li><a href="global.html#s3ArchiveBucket">s3ArchiveBucket</a></li><li><a href="global.html#s3CreateBucket">s3CreateBucket</a></li><li><a href="global.html#s3DeleteBucket">s3DeleteBucket</a></li><li><a href="global.html#s3DownloadObjs">s3DownloadObjs</a></li><li><a href="global.html#s3UploadObjs">s3UploadObjs</a></li><li><a href="global.html#safeMakedir">safeMakedir</a></li><li><a href="global.html#saveTextFile">saveTextFile</a></li><li><a href="global.html#setFilePermissions">setFilePermissions</a></li><li><a href="global.html#splashScreen">splashScreen</a></li><li><a href="global.html#topicTable">topicTable</a></li><li><a href="global.html#updateConfigSetting">updateConfigSetting</a></li><li><a href="global.html#updateObj">updateObj</a></li><li><a href="global.html#urlRow">urlRow</a></li><li><a href="global.html#verifyAccessToken">verifyAccessToken</a></li><li><a href="global.html#wizard">wizard</a></li><li><a href="global.html#writeConfig">writeConfig</a></li><li><a href="global.html#writeReport">writeReport</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>report/common.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * A set of common utilities for creating HTML and DOCX reports for mediumroast.io objects
 * @author Michael Hay &lt;michael.hay@mediumroast.io>
 * @file common.js
 * @copyright 2022 Mediumroast, Inc. All rights reserved.
 * @license Apache-2.0
 */

// Import modules
import docx from 'docx'
import * as fs from 'fs'
import boxPlot from 'box-plot'


// TODO Change class names to: GenericUtilities, DOCXUtilities and HTMLUtilities
// TODO rankTags belongs to GenericUtilities

class DOCXUtilities {
    /**
     * To make machine authoring of a Microsoft DOCX file consistent and easier this class has been 
     * developed.  Key functions are available that better describe the intent of the operation
     * by name which makes it simpler author a document instead of sweating the details.
     * Further through trial and error the idiosyncrasies of the imported docx module
     * have been worked out so that the developer doesn't have to accidently find out and struggle
     * with document generation. 
     * @constructor
     * @classdesc Core utilities for generating elements in a Microsoft word DOCX file
     * @param {String} font 
     * @param {Float} fontSize 
     * @param {Float} textFontSize 
     * @param {String} textFontColor
     * @todo when we get to HTML report generation for the front end we will rename this class and create a new one for HTML
     * @todo adopt settings.js
     */
    constructor (font, fontSize, textFontSize, textFontColor) {
        this.font = font ? font : 'Avenir Next'
        this.heavyFont = 'Avenir Next Heavy'
        this.size = fontSize ? fontSize : 11
        this.textFontSize = textFontSize ? textFontSize : 22
        this.textFontColor = textFontColor ? textFontColor : '#41a6ce'
        this.fontFactor = 1
        this.styling = this.initStyles()
        this.regions = {
            AMER: 'Americas',
            EMEA: 'Europe, Middle East and Africa',
            APAC: 'Asia Pacific and Japan'
        }
    }

    // Initialize the common styles for the docx
    initStyles () {
        const hangingSpace = 0.18
        return {
                default: {
                    heading1: {
                        run: {
                            size: this.textFontSize,
                            bold: true,
                            font: this.font,
                            color: this.textFontColor
                        },
                        paragraph: {
                            spacing: {
                                before: 160,
                                after: 80,
                            },
                        },
                    },
                    heading2: {
                        run: {
                            size: 0.75 * this.textFontSize,
                            bold: true,
                            font: this.font,
                            color: this.textFontColor
                        },
                        paragraph: {
                            spacing: {
                                before: 240,
                                after: 120,
                            },
                        },
                    },
                    heading3: {
                        run: {
                            size: 0.8 * this.textFontSize,
                            bold: true,
                            font: this.font,
                            color: this.textFontColor
                        },
                        paragraph: {
                            spacing: {
                                before: 240,
                                after: 120,
                            },
                        },
                    },
                    listParagraph: {
                        run: {
                            font: this.font,
                            size: 1.5 * this.size,
                        },
                    },
                    paragraph: {
                        font: this.font,
                        size: this.size,
                    }
                },
                paragraphStyles: [
                    {
                        id: "mrNormal",
                        name: "MediumRoast Normal",
                        basedOn: "Normal",
                        next: "Normal",
                        quickFormat: true,
                        run: {
                            font: this.font,
                            size: this.size,
                        },
                    },
                ],
                numbering: {
                    config: [
                        {
                            reference: 'number-styles',
                            levels: [
                                {
                                    level: 0,
                                    format: docx.LevelFormat.DECIMAL,
                                    text: "%1.",
                                    alignment: docx.AlignmentType.START,
                                    style: {
                                        paragraph: {
                                            indent: { 
                                                left: docx.convertInchesToTwip(0.25), 
                                                hanging: docx.convertInchesToTwip(hangingSpace) 
                                            },
                                            spacing: {
                                                before: 75
                                            }
                                        },
                                    },
                                },
                                {
                                    level: 1,
                                    format: docx.LevelFormat.LOWER_LETTER,
                                    text: "%2.",
                                    alignment: docx.AlignmentType.START,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(0.50), hanging: docx.convertInchesToTwip(hangingSpace) },
                                        },
                                    },
                                },
                                {
                                    level: 2,
                                    format: docx.LevelFormat.LOWER_ROMAN,
                                    text: "%3.",
                                    alignment: docx.AlignmentType.START,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(0.75), hanging: docx.convertInchesToTwip(hangingSpace) },
                                        },
                                    },
                                },
                                {
                                    level: 3,
                                    format: docx.LevelFormat.UPPER_LETTER,
                                    text: "%4.",
                                    alignment: docx.AlignmentType.START,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(1.0), hanging: docx.convertInchesToTwip(hangingSpace) },
                                        },
                                    },
                                },
                                {
                                    level: 4,
                                    format: docx.LevelFormat.UPPER_ROMAN,
                                    text: "%5.",
                                    alignment: docx.AlignmentType.START,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(1.25), hanging: docx.convertInchesToTwip(hangingSpace) },
                                        },
                                    },
                                },
                            ]
                        },
                        {
                            reference: "bullet-styles",
                            levels: [
                                {
                                    level: 0,
                                    format: docx.LevelFormat.BULLET,
                                    text: "-",
                                    alignment: docx.AlignmentType.LEFT,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(0.5), hanging: docx.convertInchesToTwip(0.25) },
                                        },
                                    },
                                },
                                {
                                    level: 1,
                                    format: docx.LevelFormat.BULLET,
                                    text: "\u00A5",
                                    alignment: docx.AlignmentType.LEFT,
                                    style: {
                                        paragraph: {
                                            indent: { left: docx.convertInchesToTwip(1), hanging: docx.convertInchesToTwip(0.25) },
                                        },
                                    },
                                },
                                {
                                    level: 2,
                                    format: docx.LevelFormat.BULLET,
                                    text: "\u273F",
                                    alignment: docx.AlignmentType.LEFT,
                                    style: {
                                        paragraph: {
                                            indent: { left: 2160, hanging: docx.convertInchesToTwip(0.25) },
                                        },
                                    },
                                },
                                {
                                    level: 3,
                                    format: docx.LevelFormat.BULLET,
                                    text: "\u267A",
                                    alignment: docx.AlignmentType.LEFT,
                                    style: {
                                        paragraph: {
                                            indent: { left: 2880, hanging: docx.convertInchesToTwip(0.25) },
                                        },
                                    },
                                },
                                {
                                    level: 4,
                                    format: docx.LevelFormat.BULLET,
                                    text: "\u2603",
                                    alignment: docx.AlignmentType.LEFT,
                                    style: {
                                        paragraph: {
                                            indent: { left: 3600, hanging: docx.convertInchesToTwip(0.25) },
                                        },
                                    },
                                },
                            ]
                        }
                    ]}
            }
    }

    /**
     * @function makeBullet
     * @description Create a bullet for a bit of prose
     * @param {String} text - text/prose for the bullet
     * @param {Integer} level - the level of nesting for the bullet
     * @returns {Object} new docx paragraph object as a bullet
     */
    makeBullet(text, level=0) {
        return new docx.Paragraph({
            text: text,
            numbering: {
                reference: 'bullet-styles',
                level: level
            }
        })
    }

    /**
     * @function makeHeader
     * @description Generate a header with an item's name and the document type fields
     * @param {String} itemName 
     * @param {String} documentType 
     * @param {Boolean} landscape 
     */
    makeHeader(itemName, documentType, landscape=false) {
        let separator = "\t".repeat(3)
        if (landscape) { separator = "\t".repeat(4)}
        return new docx.Header({
            children: [
                new docx.Paragraph({
                    alignment: docx.AlignmentType.CENTER,
                    children: [
                        new docx.TextRun({
                            children: [documentType],
                            font: this.font,
                            size: 20
                        }),
                        new docx.TextRun({
                            children: [itemName],
                            font: this.heavyFont,
                            size: 20,
                            color: "c7701e"
                        })
                    ],
                }),
            ],
        })
    }

    makeFooter(documentAuthor, datePrepared, landscape=false) {
        let separator = "\t"
        if (landscape) { separator = "\t".repeat(2)}
        return new docx.Paragraph({
            alignment: docx.AlignmentType.CENTER,
            children: [
                new docx.TextRun({
                    children: ['Page ', docx.PageNumber.CURRENT, ' of ', docx.PageNumber.TOTAL_PAGES, separator],
                    font: this.font,
                    size: 18
                }),
                new docx.TextRun({
                    children: ['|', separator, documentAuthor, separator],
                    font: this.font,
                    size: 18
                }),
                new docx.TextRun({
                    children: ['|', separator, datePrepared],
                    font: this.font,
                    size: 18
                })
            ]
        })
    }

    /**
     * @function makeParagraph
     * @description For a section of prose create a paragraph
     * @param {String} paragraph - text/prose for the paragraph
     * @param {Integer} size - font size for the paragrah
     * @param {Boolean} bold - a boolean value for determining if the text should be bolded
     * @param {Integer} spaceAfter - an integer 1 or 0 to determine if there should be space after this element
     * @returns {Object} a docx paragraph object 
     */
    makeParagraph (paragraph, size, bold, spaceAfter) {
        return new docx.Paragraph({
            children: [
                new docx.TextRun({
                    text: paragraph,
                    font: this.font,
                    size: size ? size : 20,
                    bold: bold ? bold : false, 
                    break: spaceAfter ? spaceAfter : 0
                })
            ]
        })
    }

    // 
    /**
     * @function makeTextrun
     * @description Create a text run with or without space after
     * @param {String} text - text/prose for the textrun
     * @param {Integer} spaceAfter - an integer 1 or 0 to determine if there should be space after this element
     * @returns {Object} a docx textrun object
     */
    makeTextrun(text, spaceAfter=false) {
        const myFontSize = 16
        if (spaceAfter) {
            return new docx.TextRun({
                text: text,
                font: this.font,
                size: myFontSize,
                break: 1
            })
        } else {
            return new docx.TextRun({
                text: text,
                font: this.font,
                size: myFontSize
            })
        }
    }

    /**
     * @function pageBreak
     * @description Create a page break
     * @returns {Object} a docx paragraph object with a PageBreak
     */
    pageBreak() {
        return new docx.Paragraph({
            children: [
                new docx.PageBreak()
            ]
        })
    }

    /**
     * @function makeHeading1
     * @description Create a text of heading style 1
     * @param {String} text - text/prose for the function
     * @returns {Object} a new paragraph as a heading
     */
    makeHeading1(text) {
        return new docx.Paragraph({
            text: text,
            heading: docx.HeadingLevel.HEADING_1
        })
    }

    /**
     * @function makeHeading2
     * @description Create a text of heading style 2
     * @param {String} text - text/prose for the function
     * @returns {Object} a new paragraph as a heading
     */
    makeHeading2(text) {
        return new docx.Paragraph({
            text: text,
            heading: docx.HeadingLevel.HEADING_2
        })
    }


    /**
     * @function makeHeading3
     * @description Create a text of heading style 3
     * @param {String} text - text/prose for the function
     * @returns {Object} a new paragraph as a heading
     */
    makeHeading3(text) {
        return new docx.Paragraph({
            text: text,
            heading: docx.HeadingLevel.HEADING_3
        })
    }

    /**
     * @function makeExternalHyperLink
     * @description Create an external hyperlink
     * @param {String} text - text/prose for the function
     * @param {String} link - the URL for the hyperlink
     * @returns {Object} a new docx ExternalHyperlink object
     */
    makeExternalHyperLink(text, link) {
        return new docx.ExternalHyperlink({
            children: [
                new docx.TextRun({
                    text: text,
                    style: 'Hyperlink',
                    font: this.font,
                    size: 16
                })
            ],
            link: link
        })
    }

    /**
     * @function makeInternalHyperLink
     * @description Create an external hyperlink
     * @param {String} text - text/prose for the function
     * @param {String} link - the URL for the hyperlink within the document
     * @returns {Object} a new docx InternalHyperlink object
     */
    makeInternalHyperLink(text, link) {
        return new docx.InternalHyperlink({
            children: [
                new docx.TextRun({
                    text: text,
                    style: 'Hyperlink',
                    font: this.font,
                    size: 16,
                }),
            ],
            anchor: link,
        })
    }

    /**
     * @function makeBookmark
     * @description Create a target within a document to link to with an internal hyperlink
     * @param {String} text - text/prose for the function
     * @param {String} ident - the unique name of the bookmark
     * @returns {Object} a new docx paragraph object with a bookmark
     * @todo test and revise this function as it may need to be a textrun which can be embedded in something else
     */
    makeBookmark(text, ident) {
        return new docx.Paragraph({
            children: [
                new docx.Bookmark({
                    id: String(ident),
                    children: [
                        new docx.TextRun({text: text})
                    ]
                })
            ]
        })
    }

    /**
     * @function makeHeadingBookmark1
     * @description Create a target within a document to link to with an internal hyperlink of heading 1
     * @param {String} text - text/prose for the function
     * @param {String} ident - the unique name of the bookmark
     * @returns {Object} a new docx paragraph object with a bookmark at the heading level 1
     * @todo could we generalize this function and make the heading level a parameter in the future?
     */
    makeHeadingBookmark1(text, ident) {
        return new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_1,
            children: [
                new docx.Bookmark({
                    id: String(ident),
                    children: [
                        new docx.TextRun({text: text})
                    ]
                })
            ]
        })
    }

    /**
     * @function makeHeadingBookmark2
     * @description Create a target within a document to link to with an internal hyperlink of heading 2
     * @param {String} text - text/prose for the function
     * @param {String} ident - the unique name of the bookmark
     * @returns {Object} a new docx paragraph object with a bookmark at the heading level 2
     */
    makeHeadingBookmark2(text, ident) {
        return new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_2,
            children: [
                new docx.Bookmark({
                    id: String(ident),
                    children: [
                        new docx.TextRun({text: text})
                    ]
                })
            ]
        })
    }

    

    /**
     * @function basicRow
     * @description Basic table row to produce a name/value pair table with 2 columns
     * @param {String} name - text/prose for the cell
     * @param {String} data - text/prose for the cell
     * @returns {Object} a new docx TableRow object
     */
    basicRow (name, data) {
        // return the row
        return new docx.TableRow({
            children: [
                new docx.TableCell({
                    width: {
                        size: 20,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [this.makeParagraph(name, this.fontFactor * this.fontSize, true)]
                }),
                new docx.TableCell({
                    width: {
                        size: 80,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [this.makeParagraph(data, this.fontFactor * this.fontSize)]
                })
            ]
        })
    }

    /**
     * @function descriptionRow
     * @description Description table row to produce a name/value pair table with 2 columns
     * @param {String} id - text/prose for the cell
     * @param {String} description - text/prose for the cell
     * @returns {Object} a new docx TableRow object
     */
    descriptionRow(id, description, bold=false) {
        // return the row
        return new docx.TableRow({
            children: [
                new docx.TableCell({
                    width: {
                        size: 10,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [this.makeParagraph(id, 16, bold ? true : false)]
                }),
                new docx.TableCell({
                    width: {
                        size: 90,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [this.makeParagraph(description, 16, bold ? true : false)]
                })
            ]
        })
    }

    /**
     * @function urlRow
     * @description Hyperlink table row to produce a name/value pair table with 2 columns and an external hyperlink
     * @param {String} category - text/prose for the first column
     * @param {String} name - text/prose for the hyperlink in the second column
     * @param {String} link - the URL for the hyperlink
     * @returns {Object} a new docx TableRow object with an external hyperlink
     */
    urlRow(category, name, link) {
        // define the link to the target URL
        const myUrl = new docx.ExternalHyperlink({
            children: [
                new docx.TextRun({
                    text: name,
                    style: 'Hyperlink',
                    font: this.font,
                    size: this.fontSize
                })
            ],
            link: link
        })

        // return the row
        return new docx.TableRow({
            children: [
                new docx.TableCell({
                    width: {
                        size: 20,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [this.makeParagraph(category, this.fontFactor * this.fontSize, true)]
                }),
                new docx.TableCell({
                    width: {
                        size: 80,
                        type: docx.WidthType.PERCENTAGE
                    },
                    children: [new docx.Paragraph({children:[myUrl]})]
                })
            ]
        })
    }

    /**
     * @function basicTopicRow
     * @description Create a 3 column row for displaying topics which are the results of term extraction
     * @param {String} theme - text/prose for the theme in col 1
     * @param {Float} score - the numerical score for the term in col 2
     * @param {String} rank - a textual description of the relative priority for the term in col 3
     * @param {Boolean} bold - whether or not to make the text/prose bold typically used for header row
     * @returns {Object} a new 3 column docx TableRow object
     */
    basicTopicRow (theme, score, rank, bold) {
        const myFontSize = 16
        // return the row
        return new docx.TableRow({
            children: [
                new docx.TableCell({
                    width: {
                        size: 60,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(theme, myFontSize, bold ? true : false)]
                }),
                new docx.TableCell({
                    width: {
                        size: 20,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(score, myFontSize, bold ? true : false)]
                }),
                new docx.TableCell({
                    width: {
                        size: 20,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(rank, myFontSize, bold ? true : false)]
                }),
            ]
        })
    }

    /**
     * @function basicComparisonRow
     * @description Create a 4 column row for displaying comparisons which are the results of similarity comparisons
     * @param {String} company - text/prose for the company in col 1
     * @param {String} role - the role of the company in col 2
     * @param {Float} score - the numerical score for the term in col 3
     * @param {String} rank - a textual description of the relative priority for the company in col 4
     * @param {Boolean} bold - whether or not to make the text/prose bold typically used for header row
     * @returns {Object} a new 4 column docx TableRow object
     */
    basicComparisonRow (company, role, distance, bold) {
        const myFontSize = 16
        // return the row
        return new docx.TableRow({
            children: [
                new docx.TableCell({
                    width: {
                        size: 40,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(company, myFontSize, bold ? true : false)]
                }),
                new docx.TableCell({
                    width: {
                        size: 30,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(role, myFontSize, bold ? true : false)]
                }),
                new docx.TableCell({
                    width: {
                        size: 30,
                        type: docx.WidthType.PERCENTAGE,
                        font: this.font,
                    },
                    children: [this.makeParagraph(distance, myFontSize, bold ? true : false)]
                }),
            ]
        })
    }

    

    /**
     * @async
     * @function writeReport
     * @description safely write a DOCX report to a desired location
     * @param {Object} docObj - a complete and error free document object that is ready to be saved
     * @param {String} fileName - the file name for the DOCX object
     * @returns {Array} an array containing if the save operation succeeded, the message, and null
     */
    async writeReport (docObj, fileName) {
        try {
            await docx.Packer.toBuffer(docObj).then((buffer) => {
                fs.writeFileSync(fileName, buffer)
            })
            return [true, 'SUCCESS: Created file [' + fileName + '] for object.', null]
        } catch(err) {
            return [false, 'ERROR: Failed to create report for object.', null]
        }
     }

     /**
      * @function rankTags
      * @description Rank supplied topics and return an object that can be rendered
      * @param {Object} tags - the tags from the source object to be ranked
      * @returns {Object} the final tags which now have ranking and are suitable for a basicTopicRow
      */
     rankTags (tags) {
        const ranges = boxPlot(Object.values(tags))
        let finalTags = {}
        for (const tag in tags) {
            // Rank the tag score using the ranges derived from box plots
            // if > Q3 then the ranking is high
            // if in between Q2 and Q3 then the ranking is medium
            // if &lt; Q3 then the ranking is low
            let rank = null
            if (tags[tag] > ranges.upperQuartile) {
                rank = 'High'
            } else if (tags[tag] &lt; ranges.lowerQuartile) {
                rank = 'Low'
            } else if (ranges.lowerQuartile &lt;= tags[tag] &lt;= ranges.upperQuartile) {
                rank = 'Medium'
            }
    
            finalTags[tag] = {
                score: tags[tag], // Math.round(tags[tag]),
                rank: rank
            }
            
        }
        return finalTags
    }

    /**
     * @function topicTable
     * @description A higher level function that calls basicTopicRow to create a complete table
     * @param {Object} topics - the result of rankTags
     * @returns {Object} a complete docx table that includes topics
     * @todo Sort based upon rank from highest to lowest
     */
     topicTable(topics) {
        let myRows = [this.basicTopicRow('Keywords', 'Term Frequency', 'Rank', true)]
        // TODO When the score and rank are switched the program will fail and will not create a report.
        //      This appears to potentially be bug in docx, but as for now we will have to not change
        //      the code to swap the two columns. Utilmately, the goal would be to swap the columns to
        //      meet customer needs.
        // TODO sort the columns based upon rank
        for (const topic in topics) {
            myRows.push(this.basicTopicRow(topic, topics[topic].score.toFixed(2), topics[topic].rank))
        }
        // define the table with the summary theme information
        const myTable = new docx.Table({
            columnWidths: [60, 20, 20],
            rows: myRows,
            width: {
                size: 100,
                type: docx.WidthType.PERCENTAGE
            }
        })

        return myTable
    }



    // Create an introductory section
    /**
     * @function makeIntro
     * @description Creates a complete document with a heading of level 1
     * @param {String} introText - text/prose for the introduction
     * @returns {Object} a complete introduction with heading level 1 and a paragraph
     */
    makeIntro (introText) {
        return [
            this.makeHeading1('Introduction'),
            this.makeParagraph(introText)
        ]
    }
}

export default DOCXUtilities</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>


</body>
</html>
